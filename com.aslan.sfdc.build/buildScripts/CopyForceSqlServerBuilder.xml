
<project default="build" name="build">

	<import file="config.xml" />
	
	<property name="my.version" value="1.0.2" />
	<property name="my.tmp" value="${config.tmp.home}/CopyForceSqlServer" />
	
	<target name="setup" >
		<delete dir="${my.tmp}" quiet="true" />
		<mkdir dir="${my.tmp}" />
	</target>
	
	<target name="clean" >
		<delete dir="${my.tmp}" quiet="true" />
	</target>
	
	<target name="build" depends="setup,jar,javadoc,doc">
	
		<zip destfile="${config.release.home}/CopyForceSqlServer_${my.version}.zip" basedir="${my.tmp}" />
		<antcall target="clean" />
	</target>
	
	<target name="doc" >
		<copy  file="${config.home}/readme/CopyForceSqlServer.html" tofile="${my.tmp}/README.html" />
	</target>
	<target name="javadoc" >
		<javadoc destdir="${my.tmp}/javadoc" public="true">
			<fileset dir="${config.root}/com.aslan.sfdc.copyforce/src" />
			<fileset dir="${config.root}/com.aslan.sfdc.copyforce.sqlserver/src" />
		</javadoc>
	</target>
	<target name="jar">

		<jar destfile="${my.tmp}/CopyForceSqlServer.jar" filesetmanifest="mergewithoutmain">
			
            <manifest>
                <attribute name="Main-Class" value="com.aslan.sfdc.copyforce.sqlserver.CopyForceSQLServer"/>
                <attribute name="Class-Path" value="."/>
            </manifest>
            <zipfileset excludes="META-INF/*.SF" src="${config.partner.jar.full}"/>

			<zipfileset excludes="META-INF/*.SF" src="${config.root}/com.microsoft.sqlserver/sqljdbc4.jar"/>
            <fileset dir="${config.root}/com.aslan.sfdc.extract.sqlserver/bin"/>
            <fileset dir="${config.root}/com.aslan.sfdc.copyforce.sqlserver/bin"/>
            
            <fileset dir="${config.root}/com.aslan.parser.commandline/bin"/>
            <fileset dir="${config.root}/com.aslan.sfdc.extract/bin"/>
            
            <fileset dir="${config.root}/com.aslan.sfdc.copyforce/bin"/>
            
            
		</jar>
		
	</target>
</project>
